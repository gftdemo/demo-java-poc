\npackage com.scalesec.vulnado;\n\nimport org.springframework.http.HttpStatus;\nimport org.springframework.web.bind.annotation.*;\n\nimport java.io.Serializable;\n\n@RestController\npublic class LoginController {\n\n    @Value(\"${app.secret}\")\n    private String secret;\n\n    @CrossOrigin(origins = \"*\")\n    @PostMapping(value = \"/login\", produces = \"application/json\", consumes = \"application/json\")\n    public LoginResponse login(@RequestBody LoginRequest input) {\n        User user = User.fetch(input.username);\n        if (Postgres.md5(input.password).equals(user.hashedPassword)) {\n            return new LoginResponse(user.token(secret));\n        } else {\n            throw new Unauthorized(\"Access Denied\");\n        }\n    }\n}\n\nclass LoginRequest implements Serializable {\n\n    public String username;\n\n    public String password;\n}\n\nclass LoginResponse implements Serializable {\n\n    public String token;\n\n    public LoginResponse(String msg) {\n        this.token = msg;\n    }\n}\n\n@ResponseStatus(HttpStatus.UNAUTHORIZED)\nclass Unauthorized extends RuntimeException {\n\n    public Unauthorized(String exception) {\n        super(exception);\n    }\n}\n