\npackage com.scalesec.vulnado;\n\nimport org.jsoup.Jsoup;\nimport org.jsoup.nodes.Document;\nimport org.jsoup.nodes.Element;\nimport org.jsoup.select.Elements;\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.io.IOException;\nimport java.net.*;\n\npublic class LinkLister {\n\n    private LinkLister() {} // private constructor to hide the implicit public one\n\n    public static List\u003cString\u003e getLinks(String url) throws IOException {\n        List\u003cString\u003e result = new ArrayList\u003cString\u003e();\n        Document doc = Jsoup.connect(url).get();\n        Elements links = doc.select(\"a\");\n        for (Element link : links) {\n            result.add(link.absUrl(\"href\"));\n        }\n        return result;\n    }\n\n    public static List\u003cString\u003e getLinksV2(String url) throws BadRequest {\n        try {\n            URL aUrl = new URL(url);\n            String host = aUrl.getHost();\n            // replace this use of System.out by a logger\n            //System.out.println(host);\n            if (host.startsWith(\"172.\") || host.startsWith(\"192.168\") || host.startsWith(\"10.\")) {\n                throw new BadRequest(\"Use of Private IP\");\n            } else {\n                return getLinks(url);\n            }\n        } catch (Exception e) {\n            throw new BadRequest(e.getMessage());\n        }\n    }\n}\n